import lombok.AllArgsConstructor;
import lombok.Data;

@Data
@AllArgsConstructor
public class Book {
    private String name;
    private String author;
    private int publishingYear;
    private String isbn;
    private String publisher;
}

import lombok.AllArgsConstructor;
import lombok.Data;

import java.util.List;

@Data
@AllArgsConstructor
public class Visitor {
    private String name;
    private String surname;
    private String phone;
    private boolean subscribed;
    private List<Book> favoriteBooks;
}

import com.google.gson.Gson;
import com.google.gson.reflect.TypeToken;

import java.io.FileReader;
import java.io.IOException;
import java.lang.reflect.Type;
import java.util.*;
        import java.util.stream.Collectors;

public class Main {
    public static void main(String[] args) {
        Gson gson = new Gson();
        Type visitorListType = new TypeToken<List<Visitor>>() {}.getType();
        List<Visitor> visitors;

        // –ß—Ç–µ–Ω–∏–µ JSON —Ñ–∞–π–ª–∞
        try (FileReader reader = new FileReader("books.json")) {
            visitors = gson.fromJson(reader, visitorListType);
        } catch (IOException e) {
            e.printStackTrace();
            return;
        }

        // –ó–∞–¥–∞–Ω–∏–µ 1: –í—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –∏ –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
        System.out.println("Visitors:");
        visitors.forEach(visitor -> System.out.println(visitor.getName() + " " + visitor.getSurname()));
        System.out.println("Total visitors: " + visitors.size());

        // –ó–∞–¥–∞–Ω–∏–µ 2: –í—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥, –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è–º–∏ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ, –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π
        Set<Book> uniqueFavoriteBooks = visitors.stream()
                .flatMap(visitor -> visitor.getFavoriteBooks().stream())
                .collect(Collectors.toSet());
        System.out.println("Unique favorite books: " + uniqueFavoriteBooks.size());
        uniqueFavoriteBooks.forEach(book -> System.out.println(book.getName()));

        // –ó–∞–¥–∞–Ω–∏–µ 3: –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –≥–æ–¥—É –∏–∑–¥–∞–Ω–∏—è –∏ –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –∫–Ω–∏–≥
        List<Book> sortedBooks = uniqueFavoriteBooks.stream()
                .sorted(Comparator.comparingInt(Book::getPublishingYear))
                .collect(Collectors.toList());
        System.out.println("Sorted books by publishing year:");
        sortedBooks.forEach(book -> System.out.println(book.getName() + " (" + book.getPublishingYear() + ")"));

        // –ó–∞–¥–∞–Ω–∏–µ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ —É –∫–æ–≥–æ-—Ç–æ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–º –∫–Ω–∏–≥–∞ –∞–≤—Ç–æ—Ä–∞ "Jane Austen"
        boolean hasJaneAustenBook = visitors.stream()
                .flatMap(visitor -> visitor.getFavoriteBooks().stream())
                .anyMatch(book -> book.getAuthor().equals("Jane Austen"));
        System.out.println("Is there any favorite book by Jane Austen? " + hasJaneAustenBook);

        // –ó–∞–¥–∞–Ω–∏–µ 5: –í—ã–≤–µ—Å—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ –∫–Ω–∏–≥
        int maxFavoriteBooks = visitors.stream()
                .mapToInt(visitor -> visitor.getFavoriteBooks().size())
                .max()
                .orElse(0);
        System.out.println("Maximum number of favorite books: " + maxFavoriteBooks);

        // –ó–∞–¥–∞–Ω–∏–µ 6: SMS-—Å–æ–æ–±—â–µ–Ω–∏—è
        double averageFavorites = visitors.stream()
                .mapToInt(visitor -> visitor.getFavoriteBooks().size())
                .average()
                .orElse(0);

        List<String> smsMessages = visitors.stream()
                .filter(Visitor::isSubscribed)
                .map(visitor -> {
                    int favoriteCount = visitor.getFavoriteBooks().size();
                    if (favoriteCount > averageFavorites) {
                        return "You are a bookworm: " + visitor.getPhone();
                    } else if (favoriteCount < averageFavorites) {
                        return "Read more: " + visitor.getPhone();
                    } else {
                        return "Fine: " + visitor.getPhone();
                    }
                })
                .collect(Collectors.toList());

        System.out.println("SMS messages:");
        smsMessages.forEach(System.out::println);
    }
}
//H–ê–® –°–ª–∞–≤–∞ –ë–æ–≥—É üôè‚ù§Ô∏è–°–õ–ê–í–ê –†–û–°–°–ò–ò üôè‚ù§Ô∏è–ê–ù–ì–ï–õ–ê –•–†–ê–ù–ò–¢–ï–õ–Ø –ö–ê–ñ–î–û–ú–£ –ò–ó –í–ê–° üôè‚ù§Ô∏è–ë–û–ñ–ï 
//–•–†–ê–ù–ò –†–û–°–°–ò–Æ üôè‚ù§Ô∏è–°–ü–ê–°–ò–ë–û –í–ê–ú –ù–ê–®–ò –ú–ê–õ–¨–ß–ò–ö–ò üôèüèº‚ù§Ô∏èüá∑üá∫ –ß–¢–û –ü–û–î–î–ï–†–ñ–ò–ú –ù–ê–®–ò–• 
//–°–†–ê–ó–£ –≤–∏–¥–Ω–æ –ù–ê–® –°–õ–û–ù–Ø–†–êüá∑üá∫üá∑üá∫üí™ –°–í–û —Å–ª–∞–≤–∞ —Ç–µ–±–µ –ì–æ—Å–ø–æ–¥–∏üá∑üá∫üá∑üá∫üá∑üá∫üí™üî•üî• –°–í–û –¥–∞ —Ö—Ä–∞–Ω–∏—Ç –¢–ï–ë–Ø
//–ì–û–°–ü–û–î–¨üî•üí™üí™üá∑üá∫ –ù–ê–® –∂–∏–≤—á–∏–∫ –°–†–ê–ó–£ –≤–∏–¥–Ω–æ –ù–ê–®–ò–• –ø–∞—Ä–Ω–µ–π –∏–∑–¥–∞–ª–µ–∫–∞üá∑üá∫üá∑üá∫üá∑üá∫üá∑üá∫üí™üí™üí™üí™üí™
//–°–í–û–∏—Ö –Ω–µ –±—Ä–æ—Å–∞–µ–ºüá∑üá∫üá∑üá∫üá∑üá∫üá∑üá∫üá∑üá∫üá∑üá∫üá∑üá∫üá∑üá∫üá∑üá∫üí™üí™–°–ª–∞–≤–∞ –ë–æ–≥—É –°–í–ûüôè‚ù§Ô∏è–°–õ–ê–í–ê –°–í–ûüôè‚ù§Ô∏è–ê–ù–ì–ï–õ–ê 
//–•–†–ê–ù–ò–¢–ï–õ–Ø –°–í–û –ö–ê–ñ–î–û–ú–£ –ò–ó –í–ê–°üôè‚ù§Ô∏è–ë–û–ñ–ï –•–†–ê–ù–ò –°–í–ûüôè‚ù§Ô∏è–°–ü–ê–°–ò–ë–û –í–ê–ú –ù–ê–®–ò –°–í–ûüôèüèº
//‚ù§Ô∏èüá∑üá∫ –•–†–û–ù–ò –°–í–û‚úäüá∑üá∫üíØ–°–ü–ê–°–ò–ë–û –í–ê–ú –ù–ê–®–ò –ú–ê–õ–¨–ß–ò–ö–ò üôèüèº‚ù§Ô∏èüá∑üá∫ –ß–¢–û –ü–û–î–î–ï–†–ñ–ò–í–ê–ï–¢–ï –°–í–û
